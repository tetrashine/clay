var clay=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function a(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.r(e);var d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(h,t);var e,n,i,o,d=(e=h,function(){var t,n=s(e);if(l()){var i=s(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return a(this,t)});function h(){return r(this,h),d.apply(this,arguments)}return n=h,(i=[{key:"appendChild",value:function(t){this.elem.appendChild(t.elem),t._parent=this.elem}},{key:"appendToDom",value:function(t){t.appendChild(this.elem)}},{key:"createDomElement",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o=["svg","g","text","rect","foreignobject"].indexOf(e.toLowerCase())>=0?this.createSvgElement:this.createNonSvgElement,r=o.call(this,t,e);return r.innerHTML=n,r._svg=n,r._cancel=i,r}},{key:"createNonSvgElement",value:function(t,e){return t.createElement(e)}},{key:"createSvgElement",value:function(t,e){return t.createElementNS("http://www.w3.org/2000/svg",e)}},{key:"remove",value:function(){this.elem.remove()}},{key:"elem",get:function(){return this._sel},set:function(t){this._sel=t,t.node=this}}])&&c(n.prototype,i),o&&c(n,o),h}(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._events={}}var e,n,o;return e=t,(n=[{key:"_defaulted",value:function(t){this._events[t]||(this._events[t]=[])}},{key:"off",value:function(t,e){this._defaulted(t);for(var n=this._events[t],i=n.length-1;i>=0;i++)if(n[i]===e){n.splice(i,1);break}}},{key:"on",value:function(t,e){this._defaulted(t),this._events[t].push(e)}},{key:"once",value:function(t,e){var n=this;this._defaulted(t),this._events[t].push((function i(){for(var o=arguments.length,r=new Array(o),c=0;c<o;c++)r[c]=arguments[c];e.call.apply(e,[n].concat(r)),n.off(t,i)}))}},{key:"trigger",value:function(t){for(var e=this,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];this._events[t]&&this._events[t].forEach((function(t){t.call.apply(t,[e].concat(i))}))}}])&&i(e.prototype,n),o&&i(e,o),t}());function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function y(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?b(t):e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function v(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function m(t,e){return(m=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){return function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&m(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=g(e);if(v()){var i=g(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return y(this,t)});function c(){var t;f(this,c);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(t=r.call.apply(r,[this].concat(n))).clickFn=function(e){t.trigger("click",b(t))},t}return n=c,(i=[{key:"selectable",value:function(){this._sel.addEventListener("click",this.clickFn)}},{key:"destroy",value:function(){this._sel.removeEventListener("click",this.clickFn)}},{key:"unselect",value:function(){this._selected=!1}},{key:"select",value:function(){this._selected=!0}},{key:"selected",get:function(){return this._selected}}])&&p(n.prototype,i),o&&p(n,o),c}(t)};function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function x(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function w(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function S(t){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var O=function(t){return t.changedTouches&&(t=t.changedTouches[0]),{x:t.clientX,y:t.clientY}},A=_(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=S(e);if(C()){var i=S(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return w(this,t)});function c(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(t=r.call(this))._enabled=!1,t._dragged=!1,t}return n=c,(i=[{key:"draggable",value:function(t){this._enabled=!0,this.startDragFn=this.startDrag.bind(this),this.dragFn=this.drag.bind(this),this.endDragFn=this.endDrag.bind(this),this.init(this.enabled,t)}},{key:"init",value:function(t,e){e.addEventListener("mousedown",this.startDragFn),e.addEventListener("touchstart",this.startDragFn,{passive:!1})}},{key:"startListening",value:function(){this.elem.addEventListener("mousedown",this.startDragFn),this.elem.addEventListener("touchstart",this.startDragFn,{passive:!1})}},{key:"stopListening",value:function(){this.elem.removeEventListener("mousedown",this.startDragFn),this.elem.removeEventListener("touchstart",this.startDragFn,{passive:!1})}},{key:"destroy",value:function(){this.stopListening()}},{key:"startDrag",value:function(t){t.preventDefault(),t.stopPropagation();var e=O(t),n=this._sel.getBoundingClientRect();this.offset={x:e.x-n.x,y:e.y-n.y},window.addEventListener("mousemove",this.dragFn),window.addEventListener("touchmove",this.dragFn,{passive:!1}),window.addEventListener("mouseup",this.endDragFn),window.addEventListener("touchend",this.endDragFn,{passive:!1})}},{key:"drag",value:function(t){this._dragged=!0;var e=this.offset,n=O(t),i=n.x-e.x,o=n.y-e.y;this.setXY(i,o),this.trigger("drag",i,o)}},{key:"endDrag",value:function(t){this._dragged||this.trigger("clickonly"),this._dragged=!1,window.removeEventListener("mousemove",this.dragFn),window.removeEventListener("touchmove",this.dragFn),window.removeEventListener("mouseup",this.endDragFn),window.removeEventListener("touchend",this.endDragFn)}},{key:"setXY",value:function(t,e){this._x=t,this._y=e}},{key:"isDragging",value:function(){return this._dragged}}])&&x(n.prototype,i),o&&x(n,o),c}(d)),M=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",o='class="'.concat(n,'"'),r='style="'.concat(i,'"'),c='width="'.concat(e,'" height="').concat(e,'"');return"<svg ".concat(o," ").concat(r,' viewBox="0 0 24 24" ').concat(c,'><g><g><path d="').concat(t,'"/></g></g></svg>')},L=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{className:"",style:""},n=e.className,i=e.style;return M(t,18,n,i)},j=(L("M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"),L("M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z")),I=L("M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"),P=L("M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"),T=L("M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1zM18 7H6v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7z"),D=L("M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"),z=L("M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z",{style:"fill:#E21B1B;"}),R=L("M8 5v14l11-7z"),F=L("M6 19h4V5H6v14zm8-14v14h4V5h-4z"),N=L("M6 6h12v12H6z"),B=L("M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"),H=L("M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"),Z=L("M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"),V=L("M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"),G=L("M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z"),U=L("M11 3L5.5 17h2.25l1.12-3h6.25l1.12 3h2.25L13 3h-2zm-1.38 9L12 5.67 14.38 12H9.62z");function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t){return function(t){if(Array.isArray(t))return X(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return X(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function J(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Q(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function q(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var et=new(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=$(e);if(K()){var i=$(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return q(this,t)});function c(){return J(this,c),r.apply(this,arguments)}return n=c,(i=[{key:"generate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i='<table xmlns="http://www.w3.org/2000/svg" class="paper tb">\n      <thead class="tb-hd"><tr class="tb-rw">'.concat([""].concat(Y(e)).map((function(t){return'<th class="tb-cell-hd">'.concat(t,"</th>")})).join(""),'</tr></thead>\n      <tbody class="tb-bd">').concat(n.map((function(t,e){return Array.isArray(t)?'<tr class="tb-rw"><td class="tb-cell">'.concat(e+1,".</td>").concat(t.map((function(t,e){return'<td class="tb-cell">'.concat(t,"</td>")})).join(""),"</tr>"):'<tr class="tb-rw"><td class="tb-cell">'.concat(e+1,'.</td><td class="tb-cell">').concat(t,"</td></tr>")})).join(""),"</tbody>\n    </table>"),o=this.createDomElement(t,"foreignObject",i);return o.setAttribute("width",420),o.setAttribute("height",70+40*n.length),o}}])&&Q(n.prototype,i),o&&Q(n,o),c}(d)),nt="#D0D0D0",it="#1565c0",ot=4,rt=30,ct="#B9C4D2",at="#1565c0",lt=1,st=10,ut="#B9C5D1",dt="#75C750",ht="#89959F",ft="#F86C03",pt="#2196f3",yt="rgba(33,150,243,.15)";function bt(t){return function(t){if(Array.isArray(t))return vt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return vt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function gt(t){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function kt(t,e,n){return(kt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ct(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function xt(t,e){return!e||"object"!==gt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function wt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ct(t){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function St(t,e){return(St=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Et=60,Ot=rt,At="#DFE7ED",Mt="#89959F",Lt=ct,jt="#89959F",It=0,Pt=5,Tt=st,Dt=5,zt=ht,Rt="#F86C03",Ft="#4caf50",Nt=5,Bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&St(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=Ct(e);if(wt()){var i=Ct(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return xt(this,t)});function c(t,e){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};mt(this,c),n=r.call(this);var o=i.width,a=void 0===o?Et:o,l=i.height,s=void 0===l?Ot:l,u=i.editable,d=i.attrs,h=void 0===d?[]:d;return n._doc=t,n._config=i,n._width=a,n._height=s,n._selected=!1,n._editable=u,n._inputCount=0,n._outputCount=1,n._attrs=h,n._links=[],n._inputLinks=[],n._outputLinks=[],n._node=e,n.validateNodeConfig(e),n.parseNodeConfig(e),n.initialize(t,i),n}return n=c,(i=[{key:"validateNodeConfig",value:function(t){var e=this;if(!t||"object"!==gt(t))throw Error("Invalid NodeConfig: Invalid NodeConfig type.");var n=t.type,i=t.inputs,o=t.outputs;if(!n&&"string"!=typeof n)throw Error("Invalid NodeConfig: Invalid type attribute.");if(this.validateIoType(n))throw Error('Invalid NodeConfig: Invalid NodeConfig type. Can only accept "string", "boolean", "integer", "function"');if("function"===n){if(!i||!o)throw Error("Invalid NodeConfig: No inputs or outputs in function node.");if(!Array.isArray(i)||!Array.isArray(o))throw Error("Invalid NodeConfig: invalid inputs/outputs type.");var r=["inputs","outputs"];[i,o].forEach((function(t,n){t.forEach((function(t,i){if(!t&&"string"!=typeof t)throw Error("Invalid NodeConfig: Invalid ".concat(r[n]," type on index (").concat(i,"). Only string can be accepted."));if(e.validateIoType(t))throw Error("Invalid NodeConfig: Invalid ".concat(r[n]," type on index (").concat(i,'). Values can only be "string", "boolean", "integer", "function"'))}))}))}}},{key:"validateIoType",value:function(t){return["string","boolean","integer","function"].indexOf(t)<0}},{key:"parseNodeConfig",value:function(t){"function"===t.type&&(this._inputCount=t.inputs.length,this._outputCount=t.outputs.length)}},{key:"addLink",value:function(t,e){"input"===e?this._inputLinks.push(t):"input"===e&&this._outputLinks.push(t),this._links.push(t)}},{key:"delLink",value:function(t){var e=this._inputLinks.indexOf(t),n=this._outputLinks.indexOf(t);e>=0&&this._inputLinks.splice(e,1),n>=0&&this.outputIndex.splice(n,1),this._links.splice(this._links.indexOf(t),1)}},{key:"setFillColor",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At;this._bg.setAttribute("style","fill:".concat(t,";stroke-width:").concat(It,";stroke:").concat(Lt,";filter:drop-shadow(0px 1px 1px rgba(0,0,0,.4));"))}},{key:"setFontColor",value:function(t){var e=this._config.fontSize,n=void 0===e?11:e;this._config.fontColor=t,this._text.setAttribute("style","font-size:".concat(n,"px;color:").concat(t,";overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;"))}},{key:"initialize",value:function(t,e){var n,i=e.x,o=void 0===i?0:i,r=e.y,c=void 0===r?0:r,a=e.title,l=void 0===a?"":a,s=e.fontSize,u=void 0===s?11:s,d=e.color,h=void 0===d?At:d,f=e.fontColor,p=void 0===f?jt:f,y=(e.description,this.elem=this.createSvgElement(t,"g"));y.setAttribute("transform","translate(".concat(o,",").concat(c,")")),this._bg=n=this.createSvgElement(t,"rect"),n.setAttribute("width",this._width),n.setAttribute("height",this._height),n.setAttribute("rx",Pt),n.setAttribute("ry",Pt),this.setFillColor(h),y.appendChild(n);var b,v=this.createSvgElement(t,"foreignObject");v.setAttribute("class","no-mouse"),v.setAttribute("x",Pt),v.setAttribute("y",Pt),v.setAttribute("width",this._width-2*Pt),v.setAttribute("height",this._height-2*Pt),this._text=b=this.createNonSvgElement(t,"div"),b.setAttribute("contenteditable","true"),b.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),b.setAttribute("style","font-size:".concat(u,"px;color:").concat(p,";overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;")),b.innerHTML=l,v.appendChild(b),y.appendChild(v),this._editable&&this.draggable(y)}},{key:"destroy",value:function(){this.remove()}},{key:"select",value:function(){var t;kt(Ct(c.prototype),"select",this).call(this),this._selected=t=this.createSvgElement(this._doc,"rect"),t.setAttribute("class","highlight"),t.setAttribute("width",this._width),t.setAttribute("height",this._height),this.elem.appendChild(t),this.drawInputLinkables(),this.drawOutputLinkables(),this.drawMenu(),this._links.forEach((function(t){return t.redrawPath()}))}},{key:"unselect",value:function(){var t=this;kt(Ct(c.prototype),"unselect",this).call(this),[".highlight","#menu-btn","#svg-table"].forEach((function(e){var n=t.elem.querySelector(e);null!==n&&t.elem.removeChild(n)})),this.removeLinkables(),this._links.forEach((function(t){return t.redrawPath()}))}},{key:"drawMenu",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._menuState=e;var n=this.createSvgElement(this._doc,"g");n.setAttribute("id","menu-btn"),n.setAttribute("style","transform: translate(0,".concat(this._height+10,"px);"));var i=e?I:j,o=this.createDomElement(this._doc,"g",i).lastChild;this.appendIconAttrs(o);var r=this.createSvgElement(this._doc,"foreignObject");r.setAttribute("width",25),r.setAttribute("height",25),r.setAttribute("style","background-color:rgb(238,238,238);border-radius:15px;box-shadow:0px 2px 1px -1px rgb(0 0 0 / 20%),0px 1px 1px 0px rgb(0 0 0 / 14%),0px 1px 3px 0px rgb(0 0 0 / 12%);"),n.appendChild(r),n.appendChild(o),n.addEventListener("mousedown",(function(e){e.stopImmediatePropagation(),t._menuState=!t._menuState,t.redrawMenu(t._menuState)})),this.elem.appendChild(n)}},{key:"generateTable",value:function(t,e){var n=this,i=et.generate(this._doc,["Input","Value",'<button class="icon-btn add-btn">'.concat(D,"</button")],[].concat(bt(t),bt(this.appendWithDeleteBtn(this.toEditable(e)))));return i.setAttribute("id","svg-table"),i.setAttribute("style","transform:translate(0,70px);"),i.onmousedown=function(t){var e=t.target.parentNode;e&&"BUTTON"===e.nodeName&&"icon-btn del-btn"===e.className?(t.stopImmediatePropagation(),n._attrs.splice(parseInt(e.attributes.index.value),1),n.drawOrRefreshTable()):e&&"BUTTON"===e.nodeName&&"icon-btn add-btn"===e.className?(t.stopImmediatePropagation(),n._attrs.push({name:"",value:""}),n.drawOrRefreshTable()):"INPUT"===t.target.nodeName&&(t.stopImmediatePropagation(),n._selectedText&&(n._replacement=!0),n._selectedText=t.target,n._selectedText.onblur=function(){n._replacement?n._replacement=!1:n._selectedText=void 0})},i}},{key:"toEditable",value:function(t){return t.map((function(t,e){var n={},i={name:"Enter key",value:"Enter value"};return Object.keys(t).filter((function(t){return"placeholder"!==t})).map((function(o){n[o]='<input value="'.concat(t[o],'" placeholder="').concat(i[o],'" index="').concat(e,'" key="').concat(o,'" />')})),n}))}},{key:"drawOrRefreshTable",value:function(){var t=this.elem.querySelector("#svg-table");t&&this.elem.removeChild(t),this.elem.appendChild(this.generateTable(this.getPermAttributes(),this.getAttributes()))}},{key:"redrawMenu",value:function(t){var e,n=this._doc.getElementById("menu-icon");if(t)e=this.createDomElement(this._doc,"g",I).lastChild,this.drawOrRefreshTable();else{e=this.createDomElement(this._doc,"g",j).lastChild;var i=this.elem.querySelector("#svg-table");this.elem.removeChild(i)}this.appendIconAttrs(e),n.replaceWith(e)}},{key:"getPermAttributes",value:function(){return[["Index",this.getIndex()," "]]}},{key:"getAttributes",value:function(){return this._attrs}},{key:"appendWithDeleteBtn",value:function(t){return t.map((function(t,e){return[t.name,t.value,'<button class="icon-btn del-btn" index="'.concat(e,'">').concat(T,"</button>")]}))}},{key:"appendIconAttrs",value:function(t){t.setAttribute("id","menu-icon"),t.setAttribute("style","fill:rgba(0,0,0,.54);"),t.setAttribute("x",3),t.setAttribute("y",3)}},{key:"calculateTextSize",value:function(t,e,n){var i=t.createElement("canvas").getContext("2d");return i.font=e,{width:i.measureText(n).width,height:parseInt(i.font)}}},{key:"setXY",value:function(t,e){var n=this._parent,i=n.createSVGPoint(),o=n.getScreenCTM().inverse();i.x=t,i.y=e,i=i.matrixTransform(o),this._config.x=i.x,this._config.y=i.y,this._sel.setAttributeNS(null,"transform","translate(".concat(i.x,",").concat(i.y,")"))}},{key:"getFaceCoords",value:function(){var t=this;return["u","l","r","d"].map((function(e){return t.getFaceCoord(e)}))}},{key:"getFaceCoord",value:function(t){var e,n=this._config,i=n.x,o=void 0===i?0:i,r=n.y,c=void 0===r?0:r;switch(t){case"u":e={x:o+this._width/2,y:c,side:t};break;case"l":e={x:o,y:c+this._height/2,side:t};break;case"r":e={x:o+this._width,y:c+this._height/2,side:t};break;case"d":e={x:o+this._width/2,y:c+this._height,side:t}}return e}},{key:"isTextEditable",value:function(){return this._text._editable}},{key:"makeDefaultTextEditable",value:function(t){var e=this;if(this._selectedText)this._selectedText.onchange=function(t){var n=t.target,i=n.attributes.key.value,o=n.attributes.index.value;e._attrs[o][i]=n.value};else{var n=this._text;n._editable=!0,n.setAttribute("contenteditable","true");var i=document.createRange(),o=window.getSelection();i.setStart(n,1),i.collapse(!0),o.removeAllRanges(),o.addRange(i),this.stopListening(),n.onblur=function(){n._editable=!1,n.setAttribute("contenteditable","false"),e.startListening()}}}},{key:"exportAsJson",value:function(){var t=this._config,e=t.x,n=t.y,i=t.title,o=(t.fontSize,t.color),r=t.description;return{title:i,description:void 0===r?"":r,color:o,x:e,y:n,node:this._node,attrs:this._attrs}}},{key:"getInputCoord",value:function(t){var e=this._config,n=e.x,i=void 0===n?0:n,o=e.y,r=void 0===o?0:o;return this.selected?this.getInputCoordByIndex(t):{x:i,y:r+this._height/2}}},{key:"getInputCoordByIndex",value:function(t){var e=this._config,n=e.x,i=void 0===n?0:n,o=e.y,r=void 0===o?0:o,c=this.calcInputCoords(0,Tt/2);return{x:i+c[t].x,y:r+c[t].y}}},{key:"getOutputCoord",value:function(t){var e=this._config,n=e.x,i=void 0===n?0:n,o=e.y,r=void 0===o?0:o;return this.selected?this.getOutputCoordByIndex(t):{x:i+this._width,y:r+this._height/2}}},{key:"getOutputCoordByIndex",value:function(t){var e=this._config,n=e.x,i=void 0===n?0:n,o=e.y,r=void 0===o?0:o,c=this.calcOutputCoords(Tt+1,Tt/2);return{x:i+c[t].x,y:r+c[t].y}}},{key:"setInputColor",value:function(){"function"!==this._node.type&&this.setFillColor(Mt)}},{key:"getIndex",value:function(){return this._index}},{key:"setIndex",value:function(t){this._index=t}},{key:"resetColor",value:function(){this.setFillColor(At)}},{key:"calcInputCoords",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._inputCount,i=-(Nt+Tt+Dt),o=n*Tt+(n-1)*Dt,r=o/2,c=r>Ot/2?-(r-Ot/2):Ot/2-r,a=[],l=0;l<n;l++)a.push({x:i+t,y:c+l*(Tt+Dt)+e});return a}},{key:"calcOutputCoords",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._outputCount,i=n*Tt+(n-1)*Dt,o=i/2,r=o>Ot/2?-(o-Ot/2):Ot/2-o,c=[],a=0;a<n;a++)c.push({x:Et+Dt+t,y:r+a*Dt+e});return c}},{key:"drawInputLinkables",value:function(t){if("function"===this._node.type){var e=this._inputCount,n=-(Nt+Tt+Dt),i=e*Tt+(e-1)*Dt,o=i/2,r=o>Ot/2?-(o-Ot/2):Ot/2-o,c=this.createSvgElement(this._doc,"foreignObject");c.setAttribute("id","inputLinkables"),c.setAttribute("width",Tt+Nt),c.setAttribute("height",i+Nt),c.setAttribute("style","transform: translate(".concat(n,"px,").concat(r,"px);"));for(var a=0;a<e;a++)c.appendChild(this.generateIoLinks(this._doc,a+1,{x:0,y:a*(Tt+Dt)},t));this.elem.appendChild(c)}}},{key:"drawOutputLinkables",value:function(t){var e=this._outputCount*Tt+(this._outputCount-1)*Dt,n=e/2,i=n>Ot/2?-(n-Ot/2):Ot/2-n,o=this.createSvgElement(this._doc,"foreignObject");o.setAttribute("id","outputLinkables"),o.setAttribute("width",Tt+Et+Dt+5),o.setAttribute("height",e+5),o.setAttribute("style","transform: translate(0,".concat(i,"px);"));for(var r=0;r<this._outputCount;r++)o.appendChild(this.generateIoLinks(this._doc,r+1,{x:Et+Dt,y:r*Dt},t));this.elem.appendChild(o)}},{key:"removeLinkables",value:function(){var t=this;["#inputLinkables","#outputLinkables"].forEach((function(e){var n=t.elem.querySelector(e);null!==n&&t.elem.removeChild(n)}))}},{key:"generateIoLinks",value:function(t,e,n,i){var o=this.createDomElement(t,"div",e);return o.setAttribute("class","io-link"),o.setAttribute("index",e),o.setAttribute("style","left:".concat(n.x,"px;top:").concat(n.y,"px;width:").concat(Tt,"px;height:").concat(Tt,"px;background-color:").concat(Ft,";border: 1px solid ").concat(zt,";border-radius:").concat(Tt,"px;")),o._node=this,o._selected=!1,o.onmouseover=function(){o._selected||(o.style.backgroundColor=Rt)},o.onmouseout=function(){o._selected||(o.style.backgroundColor=Ft)},o.onclick=function(){o.selected=!0,o.style.backgroundColor=Ft;var t=o.getAttribute("index");i(o._node,t)},o}},{key:"selected",get:function(){return this._selected}},{key:"outputCount",get:function(){return this._outputCount}}])&&_t(n.prototype,i),o&&_t(n,o),c}(A);function Ht(t){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Zt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Vt(t,e,n){return(Vt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Wt(t)););return t}(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function Gt(t,e){return!e||"object"!==Ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ut(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Wt(t){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Yt(t,e){return(Yt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Xt=rt,Jt=nt,Qt=it,qt=ot,Kt=st,$t=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yt(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=Wt(e);if(Ut()){var i=Wt(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Gt(this,t)});function c(t,e,n,i,o,a){var l,s=a.type,u=void 0===s?"regular":s,d=a.dotted,h=void 0!==d&&d,f=a.mode,p=void 0===f?"elbow":f,y=a.editable,b=void 0===y||y;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(l=r.call(this))._type=u,l._dotted=h,l._mode=p,l._editable=b,l.initialize(t,e,n,i,o),l}return n=c,(i=[{key:"_dragFn",value:function(t,e){this.redrawPath()}},{key:"getSrc",value:function(){return this._src}},{key:"getTarget",value:function(){return this._target}},{key:"setTarget",value:function(t,e){this._target.off("drag",this.dragFn),this._target.destroy(),this._target=t,this._input_index=parseInt(e)-1,t.on("drag",this.dragFn),t.addLink(this),this.redrawPath()}},{key:"setDotted",value:function(t){this._dotted=t,this.redrawPath()}},{key:"redrawPath",value:function(){var t=this._src.getOutputCoord(this._output_index),e=this._target.getInputCoord(this._input_index),n=this.elem.firstChild;n.setAttribute("stroke",this._selected?Qt:Jt),n.setAttribute("marker-end",this._selected?"url(#head-selected)":"url(#head)"),n.setAttribute("stroke-dasharray",this._dotted&&"10,10"),n.setAttribute("d",this.formPath(this._mode,t,e))}},{key:"initialize",value:function(t,e,n,i,o){this._src=e,this._output_index=parseInt(n)-1,this._target=i,this._input_index=parseInt(o)-1,e.addLink(this,"output"),i.addLink(this,"input");var r=this.elem=this.createSvgElement(t,"g"),c=t.createElementNS("http://www.w3.org/2000/svg","path");r.appendChild(c),this.dragFn=this._dragFn.bind(this),c.setAttribute("stroke-width","2"),c.setAttribute("fill","none"),this.redrawPath(),e.on("drag",this.dragFn),i.on("drag",this.dragFn)}},{key:"select",value:function(){Vt(Wt(c.prototype),"select",this).call(this),this.redrawPath()}},{key:"unselect",value:function(){Vt(Wt(c.prototype),"unselect",this).call(this),this.redrawPath()}},{key:"destroy",value:function(){this._src.off("drag",this.dragFn),this._target.off("drag",this.dragFn),this.remove()}},{key:"exportAsJson",value:function(){return{type:this._type,dotted:this._dotted,mode:this._mode,editable:this._editable,src:this._src.getIndex(),target:this._target.getIndex(),output_index:this._output_index+1,input_index:this._input_index+1}}},{key:"formPath",value:function(t,e,n){var i,o,r;switch(t){case"direct":i="M".concat(e.x,",").concat(e.y," T").concat(n.x-qt,",").concat(n.y);break;case"curve":if(Math.abs(n.y-e.y)<.2*n.y)return"M".concat(e.x,",").concat(e.y," T").concat(n.x-qt,",").concat(n.y);o=e.x+(n.x-e.x)/2,r=e.y+(n.y-e.y)/2,i="M".concat(e.x,",").concat(e.y," Q").concat(o,",").concat(e.y," ").concat(o,",").concat(r," T").concat(n.x-qt,",").concat(n.y);break;case"elbow":default:var c;o=e.x+(n.x-e.x)/2,r=e.y+(n.y-e.y)/2,n.x>=e.x+qt+3?i="M".concat(e.x,",").concat(e.y," L").concat(o,",").concat(e.y," L").concat(o,",").concat(n.y," L").concat(n.x-qt,",").concat(n.y):(c=n.y>e.y+Xt/2*2+Kt||n.y<e.y-Xt/2?1:-1,i="M".concat(e.x,",").concat(e.y," L").concat(e.x+Kt,",").concat(e.y," L").concat(e.x+Kt,",").concat(e.y+c*(Xt/2+Kt)," L").concat(n.x-Kt,",").concat(e.y+c*(Xt/2+Kt)," L").concat(n.x-Kt,",").concat(n.y," L").concat(n.x-qt,",").concat(n.y))}return i}}])&&Zt(n.prototype,i),o&&Zt(n,o),c}(_(d)),te=function(t){A.call(this),this._events={},this._coords={x:0,y:0},this._offset=t,this.moveFn=this._move.bind(this),window.addEventListener("mousemove",this.moveFn)};(te.prototype=Object.create(A.prototype)).destroy=function(){window.removeEventListener("mousemove",this.moveFn)},te.prototype.addLink=function(){},te.prototype._move=function(t){t.changedTouches&&(t=t.changedTouches[0]),this._coords={x:t.clientX-this._offset.left,y:t.clientY-this._offset.top,side:"mouse"},this.trigger("drag",this._coords.x,this._coords.y)},te.prototype.getInputCoord=te.prototype.getFaceCoord=function(){return this._coords};var ee=te,ne=0,ie=1,oe=3,re=4,ce=5,ae=6,le=0,se=1;function ue(t){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function de(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function he(t,e){return!e||"object"!==ue(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function fe(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function pe(t){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ye(t,e){return(ye=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var be=nt,ve=it,ge=ut,me=dt,_e=ht,ke=ft,xe="http://www.w3.org/2000/svg",we=function(t,e){t.changedTouches?t=t.changedTouches[0]:t.targetTouches&&(t=t.targetTouches[0]);var n=e.createSVGPoint();n.x=t.clientX,n.y=t.clientY;var i=e.getScreenCTM().inverse();return n.matrixTransform(i)},Ce=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ye(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=pe(e);if(fe()){var i=pe(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return he(this,t)});function c(t,e,n,i,o,a){var l;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(l=r.call(this))._width=n,l._height=i,l._zoom=o,l._editable=a,l._nodes=[],l._links=[],l._selected=[],l._showGrid=!1,l._type="svg",l._doc=t,l._parent=e,l._buttons={},l._scale=1,l._transformMatrix=[1,0,0,1,0,0],e.setAttribute("style",'overflow:hidden;position:absolute;background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHBhdHRlcm4gaWQ9ImdyaWQiIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgcGF0dGVyblVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHBhdGggZD0iTSAwIDEwIEwgNDAgMTAgTSAxMCAwIEwgMTAgNDAgTSAwIDIwIEwgNDAgMjAgTSAyMCAwIEwgMjAgNDAgTSAwIDMwIEwgNDAgMzAgTSAzMCAwIEwgMzAgNDAiIGZpbGw9Im5vbmUiIHN0cm9rZT0iI2UwZTBlMCIgb3BhY2l0eT0iMC4yIiBzdHJva2Utd2lkdGg9IjEiLz48cGF0aCBkPSJNIDQwIDAgTCAwIDAgMCA0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZTBlMGUwIiBzdHJva2Utd2lkdGg9IjEiLz48L3BhdHRlcm4+PC9kZWZzPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9InVybCgjZ3JpZCkiLz48L3N2Zz4=")');var s=l._sel=t.createElementNS(xe,"svg");l._refreshTransformMatrix(),s.setAttribute("viewBox","0 0 ".concat(n," ").concat(i)),s.setAttribute("width",n),s.setAttribute("height",i),s.innerText="Your browser does not support inline svg";var u=t.createElementNS(xe,"defs");u.innerHTML="\n      <marker id='head' orient=\"auto\" markerWidth='2' markerHeight='4' refX='0.1' refY='2'><path d='M0,0 V4 L2,2 Z' fill=\"".concat(be,"\"/></marker><marker id='head-selected' orient=\"auto\" markerWidth='2' markerHeight='4' refX='0.1' refY='2'><path d='M0,0 V4 L2,2 Z' fill=\"").concat(be,"\"/></marker>\n      <marker id='head-selected' orient=\"auto\" markerWidth='2' markerHeight='4' refX='0.1' refY='2'><path d='M0,0 V4 L2,2 Z' fill=\"").concat(ve,"\"/></marker><marker id='head-selected' orient=\"auto\" markerWidth='2' markerHeight='4' refX='0.1' refY='2'><path d='M0,0 V4 L2,2 Z' fill=\"").concat(be,'"/></marker>\n    '),s.appendChild(u),l._highlight=t.createElementNS(xe,"rect"),l._highlight.setAttribute("id","highlight"),l._highlight.setAttribute("width",0),l._highlight.setAttribute("height",0),s.appendChild(l._highlight);var d=t.createElementNS(xe,"rect");return d.setAttribute("width","100%"),d.setAttribute("height","100%"),d.setAttribute("style","fill:rgba(0,0,0,0);"),s.appendChild(d),e.appendChild(s),l.initialize(a),l}return n=c,(i=[{key:"_pan",value:function(t,e,n){return t[4]=e,t[5]=n,t}},{key:"_refreshTransformMatrix",value:function(t){this._sel.setAttribute("transform","matrix(".concat(this._transformMatrix.join(" "),")")),t&&this._sel.setAttribute("style","".concat(this._sel.getAttribute("style"),";transform-origin:").concat(t.x,"px ").concat(t.y,"px"))}},{key:"_zoomToScale",value:function(t,e,n){return t[0]=e,t[3]=e,t[4]=(1-e)*n.x,t[5]=(1-e)*n.y,t}},{key:"exportState",value:function(){return{editable:this._editable,nodes:this._nodes.map((function(t){return t.exportAsJson()})),links:this._links.map((function(t){return t.exportAsJson()}))}}},{key:"clearHighlight",value:function(){this._highlight.setAttribute("width",0),this._highlight.setAttribute("height",0)}},{key:"initialize",value:function(t){var e=this;t&&this.edit();var n=!1;this.elem.addEventListener("mousedown",(function(t){1===event.which&&(e._origin=we(t,e.elem),e.elem.appendChild(e._highlight))})),this.elem.addEventListener("mousemove",(function(t){if(1==event.which){var i=we(t,e.elem);if(e._mode==ae){var o=e.elem.viewBox.baseVal;o.x-=i.x-e._origin.x,o.y-=i.y-e._origin.y}else if(e._origin&&e._nodes.every((function(t){return!t.isDragging()}))){n=!0;var r=e._origin.x<i.x?e._origin.x:i.x,c=e._origin.x>i.x?e._origin.x:i.x,a=e._origin.y<i.y?e._origin.y:i.y,l=e._origin.y>i.y?e._origin.y:i.y;e._highlight.setAttribute("x",r),e._highlight.setAttribute("y",a),e._highlight.setAttribute("width",Math.abs(c-r)),e._highlight.setAttribute("height",Math.abs(l-a))}else e.clearHighlight()}})),this.elem.addEventListener("mouseup",(function(t){if(n){var i=e.elem.createSVGRect();i.x=e._highlight.attributes.x.value,i.y=e._highlight.attributes.y.value,i.width=e._highlight.attributes.width.value,i.height=e._highlight.attributes.height.value,e.unselectItems(),e.elem.getIntersectionList(i,null).forEach((function(t){var n=t.node||t.parentNode.node;n&&(n.select(),e._selected.push(n),e.trigger("onselect",e._selected))})),e.clearHighlight()}n=!1}))}},{key:"unselectItems",value:function(){this._selected.forEach((function(t){return t.unselect()})),this._selected=[]}},{key:"edit",value:function(){this._editable=!0,this._mode=ne}},{key:"addNode",value:function(t){t.selectable(),this.addToBoardItems(this._nodes,t)}},{key:"addLink",value:function(t){this._links.push(t),this.appendChild(t)}},{key:"addToBoardItems",value:function(t,e){e.setIndex(t.length),this.appendChild(e),t.push(e),this.subscribeToSelection(e)}},{key:"setMode",value:function(t){this._mode=t}},{key:"setNodes",value:function(t){var e=this;t.forEach((function(t){return e.addNode(t)}))}},{key:"setLinks",value:function(t){var e=this;this._links=t,t.forEach((function(t){return e.addLink(t)}))}},{key:"subscribeToSelection",value:function(t){var e=this;t.on("clickonly",(function(n){t.selected?(t.unselect(),e._selected.splice(e._selected.indexOf(t),1),e.trigger("ondeselect",e._selected)):(t.select(),e._selected.push(t),e.trigger("onselect",e._selected))}))}},{key:"enterSelectionMode",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this._sel.onclick=function(n){var i=we(n,t._sel);t.exitSelectionMode(),e(i)}}},{key:"enterNodeMode",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};this.enterSelectionMode((function(n){var i={x:n.x-t._transformMatrix[4],y:n.y-t._transformMatrix[5],title:"New Title",editable:t._editable},o=new Bt(t._doc,null,i);t.addNode(o),e()}))}},{key:"exitSelectionMode",value:function(){this._sel.onclick=void 0}},{key:"enterLinkMode",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},n=this,i=function i(o,r){if(t._link)n._mode=ne,t._link.setTarget(o,r),t._link.setDotted(!1),t._link.selectable(),e(),t._nodes.forEach((function(t){t.startListening(),t.removeLinkables(),t.resetColor()})),t._link=void 0;else{var c=t._link=new $t(t._doc,o,r,new ee(t.elem.getBoundingClientRect()),-1,{dotted:!0,editable:t._editable});t.addLink(c),o.addLink(c),t._nodes.forEach((function(t){t.removeLinkables(),t.drawInputLinkables(i),t.setInputColor()}))}};this._nodes.forEach((function(t){t.stopListening(),t.drawOutputLinkables(i)}))}},{key:"exitLinkMode",value:function(){this._nodes.forEach((function(t){t.removeLinkables(),t.resetColor()})),this._links.splice(this._links.indexOf(this._link),1),this._link.remove(),this._link=void 0}},{key:"enterZoomMode",value:function(t){var e=this;this._sel.onclick=function(n){var i=e._scale+.25*(t===le?1:-1),o=we(n,e._sel);e.zoom(i,o)}}},{key:"exitZoomMode",value:function(){this._sel.onclick=void 0}},{key:"zoom",value:function(t,e){this._scale=t;var n=this._sel.getBoundingClientRect(),i=e||{x:n.width/2,y:n.height/2};this._transformMatrix=this._zoomToScale(this._transformMatrix,t,i),this._refreshTransformMatrix({x:i.x/t,y:i.y/t})}},{key:"buildLinkablesByNodes",value:function(t,e,n){var i=this,o=e.map((function(e){var o=e.getFaceCoords().map((function(o){return i.generateLinkable(t,o,e,n)}));return e._linkables=o,e.on("drag",(function(t,n){o.forEach((function(t){var n=t.getAttribute("side"),i=e.getFaceCoord(n);t.style.left="".concat(i.x-5,"px"),t.style.top="".concat(i.y-5,"px")}))})),o}));return[].concat.apply([],o)}},{key:"generateLinkable",value:function(t,e,n,i){var o=this,r=this.createDomElement(t,"div","");return r.selected=!1,r.setAttribute("side",e.side),r.setAttribute("style","position:absolute;left:".concat(e.x-5,"px;top:").concat(e.y-5,"px;width:").concat(10,"px;height:").concat(10,"px;background-color: ").concat(ge,";border: 1px solid ").concat(_e,";border-radius:10px;")),r._node=n,r.onmouseover=function(){r.selected||(r.style.backgroundColor=ke)},r.onmouseout=function(){r.selected||(r.style.backgroundColor=ge)},r.onclick=function(){var t=r._node;if(o._linked)o._mode=ne,o._linked._link.setTarget(t,r.getAttribute("index")),o._linked._link.setDotted(!1),o._linked._link.selectable(),o._linked._link=void 0,o._linked.selected=!1,o._linked.style.backgroundColor=ge,o._linked=void 0,o.exitLinkMode(),i();else{o._linked=r,r.selected=!0,r.style.backgroundColor=me,t._linkables.forEach((function(t){t!=r&&(t.style.display="none")}));var e=r.getAttribute("index"),n=new $t(o._doc,t,e,new ee(o.elem.offsetLeft,o.elem.offsetTop),-1,{dotted:!0,editable:o._editable});r._link=n,o.addLink(n)}},r}},{key:"delete",value:function(t){this._nodes.splice(this._nodes.indexOf(t),1),this._links.splice(this._links.indexOf(t),1),t.destroy()}},{key:"oppositeSide",value:function(t){return{l:"r",r:"l",u:"d",d:"u"}[t]}},{key:"scale",get:function(){return this._scale}}])&&de(n.prototype,i),o&&de(n,o),c}(d);function Se(t){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ee(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Oe(t,e){return!e||"object"!==Se(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ae(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Me(t){return(Me=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Le(t,e){return(Le=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var je=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Le(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=Me(e);if(Ae()){var i=Me(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Oe(this,t)});function c(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(e=r.call(this))._doc=t,e._hidden=!0,e.initialize(),e}return n=c,(i=[{key:"initialize",value:function(){var t=this,e=this._doc,n=this._hidden,i=this._sel=e.createElement("div");i.setAttribute("style","position:absolute;background-color:white;box-shadow:rgba(60, 64, 67, 0.15) 0px 2px 6px 2px;padding:5px;width:162px;\n      ".concat(n?"visibility:hidden":"visibility:visible","\n    "));for(var o=[["#4d4d4d","#999999","#fff","#f44e3b","#fe9200","#fcdc00","#dbdf00","#a4dd00","#68ccca","#73d8ff","#aea1ff","#fda1ff"],["#333","#808080","#ccc","#d33115","#e27300","#fcc400","#b0bc00","#68bc00","#16a5a5","#68ccca","#009ce0","#7b64ff"],["#000","#666","#b3b3b3","#9f0500","#c45100","#fb9e00","#808900","#194d33","#0c797d","#0062b1","#653294","#ab149e"]],r=0;r<3;r++)for(var c=0;c<9;c++){var a=o[r][c],l=(parseInt(11*c,16),e.createElement("div"));l.setAttribute("class","btn palette"),"#fff"===a?l.setAttribute("style","\n            width: 13px;\n            height: 13px;\n            border: solid 1px #ccc;\n            background-color: ".concat(a,";\n          ")):l.setAttribute("style","\n            background-color: ".concat(a,";\n          ")),l.onclick=function(e){return function(n){n.preventDefault(),n.stopPropagation(),t.trigger("palette-select",e),t.hide()}}(a),i.appendChild(l)}}},{key:"toggle",value:function(){return this._hidden?this.show():this.hide(),!this._hidden}},{key:"hide",value:function(){this._hidden=!0,this._sel.style.visibility="hidden"}},{key:"show",value:function(){this._hidden=!1,this._sel.style.visibility="visible"}}])&&Ee(n.prototype,i),o&&Ee(n,o),c}(d),Ie=32,Pe=46;function Te(t){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function De(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function ze(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?De(Object(n),!0).forEach((function(e){Re(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Re(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var c,a=t[Symbol.iterator]();!(i=(c=a.next()).done)&&(n.push(c.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ne(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ne(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Be(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function He(t,e){return!e||"object"!==Te(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ze(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ve(t){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ge(t,e){return(Ge=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ue=at,We=lt,Ye=ct,Xe=pt,Je=yt,Qe='width="'.concat(18,'" height="').concat(18,'"'),qe="<svg ".concat('class="menu-btn"',' viewBox="0 0 490 490" ').concat(Qe,'><g><g><path d="M437.333,21.333h-384C23.936,21.333,0,45.269,0,74.667V416c0,29.397,23.936,53.333,53.333,53.333h384 c29.397,0,53.333-23.936,53.333-53.333V74.667C490.667,45.269,466.731,21.333,437.333,21.333z M469.333,416 c0,17.643-14.357,32-32,32h-384c-17.643,0-32-14.357-32-32V128h448V416z M469.333,106.667h-448v-32c0-17.643,14.357-32,32-32h384 c17.643,0,32,14.357,32,32V106.667z"/></g></g><g><g><circle cx="53.333" cy="74.667" r="10.667"/></g></g><g><g><circle cx="96" cy="74.667" r="10.667"/></g></g><g><g><circle cx="138.667" cy="74.667" r="10.667"/></g></g><g><g><path d="M394.667,320H384v-32c0-5.888-4.779-10.667-10.667-10.667H256V256h10.667c5.888,0,10.667-4.779,10.667-10.667v-42.667 c0-5.888-4.779-10.667-10.667-10.667H224c-5.888,0-10.667,4.779-10.667,10.667v42.667c0,5.888,4.779,10.667,10.667,10.667h10.667 v21.333H117.333c-5.888,0-10.667,4.779-10.667,10.667v32H96c-5.888,0-10.667,4.779-10.667,10.667v42.667    C85.333,379.221,90.112,384,96,384h42.667c5.888,0,10.667-4.779,10.667-10.667v-42.667c0-5.888-4.779-10.667-10.667-10.667H128 v-21.333h106.667V320H224c-5.888,0-10.667,4.779-10.667,10.667v42.667c0,5.888,4.779,10.667,10.667,10.667h42.667    c5.888,0,10.667-4.779,10.667-10.667v-42.667c0-5.888-4.779-10.667-10.667-10.667H256v-21.333h106.667V320H352 c-5.888,0-10.667,4.779-10.667,10.667v42.667c0,5.888,4.779,10.667,10.667,10.667h42.667c5.888,0,10.667-4.779,10.667-10.667    v-42.667C405.333,324.779,400.555,320,394.667,320z M128,362.667h-21.333v-21.333H128V362.667z M256,362.667h-21.333v-21.333H256 V362.667z M234.667,234.667v-21.333H256v21.333H234.667z M384,362.667h-21.333v-21.333H384V362.667z"/></g></g></svg>'),Ke="<svg ".concat('class="menu-btn"',' enable-background="new 0 0 551.13 551.13" viewBox="0 0 551.13 551.13" ').concat(Qe,'><path d="m465.016 172.228h-51.668v34.446h34.446v310.011h-344.457v-310.011h34.446v-34.446h-51.669c-9.52 0-17.223 7.703-17.223 17.223v344.456c0 9.52 7.703 17.223 17.223 17.223h378.902c9.52 0 17.223-7.703 17.223-17.223v-344.456c0-9.52-7.703-17.223-17.223-17.223z"/><path d="m258.342 65.931v244.08h34.446v-244.08l73.937 73.937 24.354-24.354-115.514-115.514-115.514 115.514 24.354 24.354z"/></svg>'),$e="<svg ".concat('class="menu-btn"',' viewBox="0 0 512 512" ').concat(Qe,'><path d="m410.667969 368h-117.335938c-8.832031 0-16-7.167969-16-16s7.167969-16 16-16h117.335938c8.832031 0 16 7.167969 16 16s-7.167969 16-16 16zm0 0"/><path d="m116.179688 288c-11.175782 0-21.351563-7.019531-25.320313-17.449219l-89.023437-233.707031c-1.089844-2.285156-1.835938-5.867188-1.835938-9.730469 0-14.953125 12.179688-27.113281 27.136719-27.113281 3.753906 0 7.296875.726562 10.496093 2.15625l232.9375 88.703125c10.410157 3.945313 17.429688 14.121094 17.429688 25.300781 0 11.753906-7.507812 22.121094-18.6875 25.792969l-95.9375 31.421875-31.421875 95.914062c-3.628906 11.160157-13.996094 18.710938-25.773437 18.710938zm-80.617188-252.414062 80.277344 210.644531 29.652344-90.519531c1.601562-4.839844 5.378906-8.640626 10.21875-10.21875l90.519531-29.652344zm223.636719 85.183593h.214843zm-233.769531-89.046875c.085937.019532.171874.0625.277343.085938zm5.910156-7.253906.382812 1.003906c-.105468-.277344-.234375-.640625-.382812-1.003906zm0 0"/><path d="m352 512c-88.234375 0-160-71.765625-160-160s71.765625-160 160-160 160 71.765625 160 160-71.765625 160-160 160zm0-288c-70.59375 0-128 57.40625-128 128s57.40625 128 128 128 128-57.40625 128-128-57.40625-128-128-128zm0 0"/></svg>'),tn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ge(t,e)}(c,t);var e,n,i,o,r=(e=c,function(){var t,n=Ve(e);if(Ze()){var i=Ve(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return He(this,t)});function c(t,e,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(i=r.call(this))._buttons={},i._palettes=[],i.initialize();var o=Fe(i.build(t,e,n),3);return i._dom=o[0],i._menu=o[1],i._board=o[2],i.menuCalibration=i.menuCalibration(i._config),i}return n=c,(i=[{key:"addNode",value:function(t,e){var n,i=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=this._config.editable;o?this._board.enterSelectionMode((function(o){n=new Bt(document,e,{title:t,x:o.x,y:o.y,editable:r}),i._board.addNode(n)})):(n=new Bt(document,e,{title:t,x:0,y:0,editable:r}),this._board.addNode(n))}},{key:"export",value:function(){var t=this._board.exportState();return this.trigger("export",t),t}},{key:"load",value:function(t,e){return this._load(this._dom,t,e)}},{key:"generate",value:function(t,e,n,i){var o=n.width,r=n.height,c=n.zoom,a=n.editable,l=new Ce(t,e,o,r,c,a),s=this.parseNodes(t,i.nodes,a),u=this.parseLinks(t,i.links,s,a);return l.setNodes(s),l.setLinks(u),l}},{key:"setConfig",value:function(t){this._config=this.applyDefault(t)}},{key:"setState",value:function(t){return!!this.validate(t)&&(this._state=t,!0)}},{key:"validate",value:function(t){return!0}},{key:"build",value:function(t,e,n){if(this.setConfig(e),this.setState(n))return this._build(t,this._config,this._state)}},{key:"_build",value:function(t,e,n){var i=document.createElement("style"),o=['* {font-family: "Roboto", "Helvetica", "Arial", sans-serif;} .btn{cursor:pointer;} .clay-mb{padding:5px 5px 0 5px;display:table-cell;vertical-align:middle;width:18px;margin:0 5px;position:relative;} .clay-mb.s{fill:#aaa} .clay-mb.e:hover{background-color:#ccc;cursor:pointer;} .clay-mb.e:active{background-color:#aaa;} .tooltiptext {font-size:11px;visibility:hidden;width:60px;background-color:#ccc;text-align:center;padding:3px 8px;position:absolute;z-index:1;left:0;top:29px;color:white;} .menu-btn:hover+.tooltiptext {visibility: visible;} .palette:hover{outline:#fff solid 2px;box-shadow:rgb(60, 64, 67) 0px 2px 6px 2px;} .palette{margin-right:3px;display:inline-block;width:15px;height:15px;}',"#highlight{stroke:".concat(Xe,";fill:").concat(Je,";}"),".paper{color:rgba(0, 0, 0, 0.87);transition:box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;background-color:#fff;box-shadow: 0px 2px 1px -1px rgb(0 0 0 / 20%), 0px 1px 1px 0px rgb(0 0 0 / 14%), 0px 1px 3px 0px rgb(0 0 0 / 12%);}",".tb{display:table;border-spacing:0;border-collapse:collapse;background-color:#fff;font-size:0.8rem;text-align:left;}",".tb-hd{display:table-header-group;border-bottom:solid 1px ".concat(Ye,";}"),".tb-bd{display:table-row-group;}",".tb-rw{display: table-row;outline: 0;vertical-align: middle;}",".tb-cell-hd{padding: 5px 24px 5px 16px;color: rgba(0, 0, 0, 0.87);font-weight: 500;line-height: 1.5rem;}",".tb-cell{padding: 5px 24px 5px 16px;color: rgba(0, 0, 0, 0.87);display: table-cell;font-weight: 400;line-height: 1.43;border-bottom: 1px solid rgba(224, 224, 224, 1);letter-spacing: 0.01071em;}",".tb-cell > input{width:100px;}",".icon-btn{flex:0 0 auto;background:none;padding:6px;text-align:center;border-radius:50%;border:0;cursor:pointer;margin:0;display:inline-flex;position:relative;align-items:center;user-select: none;vertical-align: middle;}",".icon-btn:hover{background-color:#eee;}",".io-link{position:absolute;font-size:8px;text-align:center;color:white;font-weight:bold;}",".no-mouse{pointer-events:none;}",".highlight{fill:rgba(0,0,0,0);stroke-width:".concat(We,";stroke:").concat(Ue,";}")];return i.innerHTML=o.join(" "),document.head.appendChild(i),this._dom=document.getElementById(t),this._load(this._dom,e,n)}},{key:"_load",value:function(t,e,n){var i=e.editable,o=i&&this.drawEditMenu(document,t,e),r=this.generate(document,t,e,n);return i&&(r.on("onselect",this.onSelection.bind(this)),r.on("ondeselect",this.onSelection.bind(this)),window.addEventListener("keydown",this.onKeyDown.bind(this)),window.addEventListener("keyup",this.onKeyUp.bind(this)),this._mode=ne),[t,o,r]}},{key:"createZoomLevelElement",value:function(t){var e=this,n=this.createDomElement(t,"div",""),i=this.createDomElement(t,"input",""),o=this.createDomElement(t,"div","%");return n.setAttribute("style","position:relative;text-align:right;display:table-cell;width:1px;font-size:10px;padding:0 10px 0 5px;vertical-align:middle;border:solid 1px #333;"),o.setAttribute("style","position: absolute;right:4px;margin-top:3px;"),i.setAttribute("value","100"),i.setAttribute("style","color:#333;width:25px;border:none;"),i.onchange=function(t){var n=parseFloat(t.target.value);e._board.zoom(n/100)},n.appendChild(o),n.appendChild(i),n}},{key:"createHrElement",value:function(t){var e=this.createDomElement(t,"span","|","");return e.setAttribute("style","color:#bbb;display:table-cell;width:1px;vertical-align:middle;"),e}},{key:"createMenuElement",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=this.createDomElement(t,"div",e,n);return i.setAttribute("class","clay-mb e"),i}},{key:"createMenuBtnElement",value:function(t){var e=t.doc,n=t.svg,i=t.cancelSvg,o=void 0===i?"":i,r=t.tooltip,c=t.enable,a=void 0===c||c,l=t.onClick,s=t.execFn,u=t.cancelFn,d=this.createMenuElement(e,n,o),h=this.createDomElement(e,"span",r);return h.setAttribute("class","tooltiptext"),d.appendChild(h),d._svg=d.innerHTML,Object.entries({onclick:l,execFn:s,cancelFn:u}).forEach((function(t){var e=Fe(t,2),n=e[0],i=e[1];i&&(d[n]=i)})),!a&&this.disableMenuBtn(d),d}},{key:"enableMenuBtn",value:function(t){t._enable=!0,t.setAttribute("class","clay-mb e")}},{key:"disableMenuBtn",value:function(t){t._enable=!1,t.setAttribute("class","clay-mb s")}},{key:"applyDefault",value:function(t){return ze({},{editable:!0,zoomable:!0,colorize:!0,exportable:!0,executable:!0},{},t)}},{key:"initialize",value:function(){}},{key:"menuCalibration",value:function(t){var e=this;return function(){[["unselect","editable"],["delete","editable"],["fill","colorize"],["fontfill","colorize"]].forEach((function(n){var i=Fe(n,2),o=i[0],r=i[1];t[r]&&(e._selected&&e._selected.length>0?e.enableMenuBtn(e._buttons[o]):e.disableMenuBtn(e._buttons[o]))}))}}},{key:"onKeyDown",value:function(t){var e=this;if(t.keyCode===Ie)this._mode=ae,this._board.setMode(ae);else if(this._selected)switch(t.keyCode){case Pe:this._palettes.forEach((function(t){return t.hide()})),this._selected.forEach((function(t){return e._board.delete(t)})),this._selected=[],this.menuCalibration();break;default:1===this._selected.length&&this._selected.makeDefaultTextEditable()}}},{key:"onKeyUp",value:function(t){switch(t.keyCode){case Ie:this._mode=ne,this._board.setMode(ne)}}},{key:"onMenuBtnClick",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"crosshair";return function(){this._mode!==t?(this._selectedSvg&&(this._selectedSvg.innerHTML=this._selectedSvg._svg,this._selectedSvg.cancelFn()),this._mode=t,e.innerHTML=e._cancel,this._selectedSvg=e,this._board.elem.style.cursor=n,e.execFn()):(this.resetMenuBtns(),e.cancelFn())}}},{key:"onSelection",value:function(t){this._selected=t,this.menuCalibration()}},{key:"save",value:function(){return this._config}},{key:"parseNodes",value:function(t,e,n){return e.map((function(e){return new Bt(t,e.node,ze({editable:n},e))}))}},{key:"parseLinks",value:function(t,e,n,i){return e.map((function(e){var o=e.src,r=e.target,c=e.output_index,a=e.input_index;return new $t(t,n[o],c,n[r],a,{editable:i})}))}},{key:"subscribe",value:function(t,e){this.on(t,e)}},{key:"drawEditMenu",value:function(t,e,n){var i,o=this,r=n.width,c=(n.height,n.editable),a=n.zoomable,l=n.colorize,s=n.exportable,u=n.executable,d=t.createElement("div");d.setAttribute("style","height:28px;width:".concat(r-1,"px;background-color:white;border:#dadce0 solid 1px;padding:6px 0;;display:table;position:absolute;border-collapse:separate;border-spacing:6px 0px;z-index:1000;"));var h=function(){o.resetMenuBtns()};if(c){var f=this.createMenuBtnElement({doc:t,svg:qe,cancelSvg:z,tooltip:"New node",execFn:function(){o._board.enterNodeMode(h)},cancelFn:function(){o._board.exitNodeMode()}});f.onclick=this.onMenuBtnClick(oe,f).bind(this),this._buttons.node=f,d.appendChild(f);var p=this.createMenuBtnElement({doc:t,svg:P,cancelSvg:z,tooltip:"New link",execFn:function(){o._board.enterLinkMode(h)},cancelFn:function(){o._board.exitLinkMode()}});p.onclick=this.onMenuBtnClick(ie,p).bind(this),this._buttons.links=p,d.appendChild(p),i=this.createHrElement(t),d.appendChild(i);var y=this.createMenuBtnElement({doc:t,svg:B,tooltip:"Undo",onClick:function(){},enable:!1});this._buttons.undo=y,d.appendChild(y);var b=this.createMenuBtnElement({doc:t,svg:H,tooltip:"Redo",onClick:function(){},enable:!1});this._buttons.redo=b,d.appendChild(b),i=this.createHrElement(t),d.appendChild(i);var v=this.createMenuBtnElement({doc:t,svg:$e,cancelSvg:z,tooltip:"Unselect",enable:!1,onClick:function(){o._selected.forEach((function(t){return t.unselect()})),o._selected=[],o.menuCalibration()}});this._buttons.unselect=v,d.appendChild(v);var g=this.createMenuBtnElement({doc:t,svg:T,cancelSvg:z,tooltip:"Delete",enable:!1,onClick:function(){o._selected.forEach((function(t){return o._board.delete(t)})),o._selected=[],o.menuCalibration()}});this._buttons.delete=g,d.appendChild(g),d.appendChild(this.createHrElement(t))}if(a){var m=this.createMenuBtnElement({doc:t,svg:Z,cancelSvg:z,tooltip:"Zoom In",execFn:function(){o._board.enterZoomMode(le)},cancelFn:function(){o._board.exitZoomMode()}});m.onclick=this.onMenuBtnClick(re,m).bind(this),this._buttons.zoomIn=m,d.appendChild(m);var _=this.createMenuBtnElement({doc:t,svg:V,cancelSvg:z,tooltip:"Zoom In",execFn:function(){o._board.enterZoomMode(se)},cancelFn:function(){o._board.exitZoomMode()}});_.onclick=this.onMenuBtnClick(ce,_).bind(this),this._buttons.zoomOut=_,d.appendChild(_);var k=this.createZoomLevelElement(t,this._board);d.appendChild(k),d.appendChild(this.createHrElement(t))}if(l){var x=this.createMenuBtnElement({doc:t,svg:G,tooltip:"Fill Color",onClick:function(){}});this._buttons.fill=x,d.appendChild(x),this.disableMenuBtn(x);var w=new je(t);w.appendToDom(x),this._palettes.push(w),x.onclick=function(t,e){return function(){t._enable&&(o._palettes.filter((function(t){return t!==e})).forEach((function(t){return t.hide()})),e.toggle()&&e.once("palette-select",(function(t){})))}}(x,w);var C=this.createMenuBtnElement({doc:t,svg:U,tooltip:"Text Color",enable:!1,onClick:function(){}});this._buttons.fontfill=C;var S=new je(t);S.appendToDom(C),this._palettes.push(S),C.onclick=function(t,e){return function(){t._enable&&(o._palettes.filter((function(t){return t!==e})).forEach((function(t){return t.hide()})),e.toggle()&&e.once("palette-select",(function(t){})))}}(C,S),d.appendChild(C),d.appendChild(this.createHrElement(t))}if(s){var E=this.createMenuBtnElement({doc:t,svg:Ke,cancelSvg:z,tooltip:"Export",onClick:function(){o.trigger("export",o._board.exportState())}});this._buttons.export=E,d.appendChild(E),d.appendChild(this.createHrElement(t))}if(u){var O=this.createMenuBtnElement({doc:t,svg:R,cancelSvg:F,tooltip:"Play",onClick:function(){}});this._buttons.play=O,d.appendChild(O);var A=this.createMenuBtnElement({doc:t,svg:N,tooltip:"Stop",onClick:function(){}});this._buttons.stop=A,d.appendChild(A)}(i=this.createMenuElement(t,"","")).setAttribute("class",""),d.appendChild(i),e.appendChild(d)}},{key:"resetMenuBtns",value:function(){this._mode=ne;var t=this._buttons;Object.keys(t).forEach((function(e){t[e].innerHTML=t[e]._svg})),this._board.elem.style.cursor="default",this._selectedSvg=void 0}}])&&Be(n.prototype,i),o&&Be(n,o),c}(d);e.default=tn}]);
//# sourceMappingURL=clay.js.map